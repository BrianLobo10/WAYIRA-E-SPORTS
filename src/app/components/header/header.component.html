<header class="header">
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <a routerLink="/">
          <img src="image.png" alt="Wayira Esports" class="logo-image">
          <span class="logo-text">WAYIRA</span>
          <span class="logo-accent">E-SPORTS</span>
        </a>
      </div>
      
      <nav #navElement class="nav" [class.active]="menuOpen">
        @if (isHomePage()) {
          <div class="nav-item dropdown" (mouseenter)="!menuOpen && toggleDropdown()" (mouseleave)="!menuOpen && closeDropdown()">
            <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="dropdown-trigger" (click)="toggleDropdown(); $event.preventDefault()">
              Inicio
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </a>
          </div>
        } @else {
          <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">Inicio</a>
        }
        <a routerLink="/search" routerLinkActive="active" class="nav-link-icon" title="Buscar Jugador">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
          <span class="nav-link-text">Buscar</span>
        </a>
        <a routerLink="/roulette" routerLinkActive="active" class="nav-link-icon roulette-link" title="Ruleta Wayira">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2-1.343-2-3-2zM12 14c-1.657 0-3 .895-3 2v1H9a2 2 0 00-2 2v1a2 2 0 002 2h6a2 2 0 002-2v-1a2 2 0 00-2-2h-1v-1c0-1.105-1.343-2-3-2zM12 14v9M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0112 20.055a11.952 11.952 0 01-8.824-4.998 12.078 12.078 0 01.665-6.479L12 14z" />
          </svg>
          <span class="nav-link-text">Ruleta</span>
        </a>
        <div class="nav-item dropdown" (mouseenter)="!menuOpen && toggleMoreDropdown()" (mouseleave)="!menuOpen && closeMoreDropdown()">
          <a class="dropdown-trigger nav-link-icon" (click)="toggleMoreDropdown(); $event.preventDefault()">
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            <span class="nav-link-text">Más</span>
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </a>
          <div class="dropdown-menu more-menu" [class.active]="moreDropdownOpen">
            <a routerLink="/about" routerLinkActive="active" class="dropdown-item">Sobre Nosotros</a>
            <a routerLink="/projects" routerLinkActive="active" class="dropdown-item">Proyectos</a>
            <a routerLink="/news" routerLinkActive="active" class="dropdown-item">Noticias</a>
            @if (isAuthenticated()) {
              <a routerLink="/blog" routerLinkActive="active" class="dropdown-item">WAYIRA RED</a>
              <a routerLink="/contact" routerLinkActive="active" class="dropdown-item">Contacto</a>
            }
          </div>
        </div>
        @if (isAuthenticated()) {
          <a routerLink="/messages" routerLinkActive="active" class="messages-link">
            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
            Mensajes
            @if (unreadMessagesCount() > 0) {
              <span class="unread-badge">{{ unreadMessagesCount() > 99 ? '99+' : unreadMessagesCount() }}</span>
            }
          </a>
          <div class="nav-item dropdown profile-dropdown" (mouseenter)="!menuOpen && toggleProfileDropdown()" (mouseleave)="!menuOpen && closeProfileDropdown()">
            <a [routerLink]="['/profile', currentUser()?.uid || '']" routerLinkActive="active" class="profile-link dropdown-trigger" (click)="toggleProfileDropdown(); $event.preventDefault()">
              @if (currentUser()?.photoURL) {
                <img 
                  [src]="currentUser()!.photoURL" 
                  [alt]="currentUser()!.displayName" 
                  class="user-avatar"
                  (error)="$any($event.target).src='https://ddragon.leagueoflegends.com/cdn/14.24.1/img/profileicon/29.png'"
                  onerror="this.onerror=null; this.src='https://ddragon.leagueoflegends.com/cdn/14.24.1/img/profileicon/29.png';">
              } @else {
                <span class="user-avatar-placeholder">
                  @if (currentUser()?.displayName) {
                    {{ currentUser()!.displayName.charAt(0).toUpperCase() }}
                  } @else {
                    U
                  }
                </span>
              }
              <span class="profile-name">{{ currentUser()?.displayName || 'Perfil' }}</span>
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </a>
            <div class="dropdown-menu profile-menu" [class.active]="profileDropdownOpen">
              <a [routerLink]="['/profile', currentUser()?.uid || '']" routerLinkActive="active" class="dropdown-item" (click)="closeProfileDropdown()">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                Mi Perfil
              </a>
              <button (click)="logout(); closeProfileDropdown()" class="dropdown-item logout-item">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                </svg>
                Cerrar Sesión
              </button>
            </div>
          </div>
        } @else {
          <a routerLink="/login" routerLinkActive="active" class="login-link">Iniciar Sesión</a>
        }
        
        @if (currentUser()) {
          <app-notifications></app-notifications>
        }
        
        @if (hasAvailableTournaments()) {
          <a [routerLink]="['/tournaments']" class="active-tournament-btn">
            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
            </svg>
            <span class="tournament-text">Torneos</span>
          </a>
        }
        
        @if (isAdmin()) {
          <a [routerLink]="['/tournaments']" [queryParams]="{create: 'true'}" class="create-tournament-btn" title="Crear Torneo">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            <span class="nav-link-text">Crear Torneo</span>
          </a>
        }
      </nav>
      
      <button class="menu-toggle" (click)="toggleMenu()" [class.active]="menuOpen">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>
</header>

